"use strict";(self.webpackChunksmart_van_2_0_github_io=self.webpackChunksmart_van_2_0_github_io||[]).push([[3132],{2535:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>g,frontMatter:()=>a,metadata:()=>l,software_category:()=>p,software_code:()=>m,software_language:()=>x,software_name:()=>h,software_status:()=>u,software_version:()=>j,toc:()=>_});var t=n(4848),r=n(8453),i=n(2349),o=n(3161);const a={title:"Customize the SVBox Structure",hide_title:!0,sidebar_position:3},c=void 0,l={id:"software/jod_smart_van/jod_smart_van/guides/customize_svbox_structure",title:"Customize the SVBox Structure",description:"\x3c!--",source:"@site/docs/software/jod_smart_van/jod_smart_van/guides/customize_svbox_structure.mdx",sourceDirName:"software/jod_smart_van/jod_smart_van/guides",slug:"/software/jod_smart_van/jod_smart_van/guides/customize_svbox_structure",permalink:"/docs/software/jod_smart_van/jod_smart_van/guides/customize_svbox_structure",draft:!1,unlisted:!1,editUrl:"https://github.com/smart-van-2-0/smart-van-2-0.github.io/edit/main/docs/software/jod_smart_van/jod_smart_van/guides/customize_svbox_structure.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Customize the SVBox Structure",hide_title:!0,sidebar_position:3},sidebar:"docsSidebar",previous:{title:"Configure JOD SV Dist.",permalink:"/docs/software/jod_smart_van/jod_smart_van/guides/configure_jod_sv_dist"},next:{title:"Manage the SVBox Firmwares",permalink:"/docs/software/jod_smart_van/jod_smart_van/guides/manage_svbox_firmwares"}},d={},h="JOD Smart Van",u="Development",m="jod_smart_van",j="1.0.0",p="Object Agent",x="JOD Distribution",_=[{value:"Customize the SmartVanBox Structure",id:"customize-the-smartvanbox-structure",level:2},{value:"SmartVan Specs",id:"smartvan-specs",level:3},{value:"SmartVanBox Structure",id:"smartvanbox-structure",level:3},{value:"SmartVanBox Capabilities",id:"smartvanbox-capabilities",level:3},{value:"Alternative JOD structures",id:"alternative-jod-structures",level:3}];function f(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Uo,{name:h,status:u}),"\n",(0,t.jsx)(s.h2,{id:"customize-the-smartvanbox-structure",children:"Customize the SmartVanBox Structure"}),"\n",(0,t.jsxs)(s.p,{children:['The JOD Distribution is configured to expose an "object structure" to the Mobile\nApp. This structure is based on the SmartVan ',(0,t.jsx)(o.hB,{}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"smartvan-specs",children:"SmartVan Specs"}),"\n",(0,t.jsxs)(s.p,{children:["The SmartVan ",(0,t.jsx)(o.hB,{})," are used to define the structure of the SmartVanBox in the\nSmartVan solution. That means, both the SmartVanBox and the Mobile App must\nfollow the same structure to communicate effectively.\nNot all the SmartVan Specs mandatory, moreover they can be provided from different\nhardware sources. That make the SmartVanBox easily customizable, including only\nthe necessary specs for the specific hardware configuration."]}),"\n",(0,t.jsx)(s.h3,{id:"smartvanbox-structure",children:"SmartVanBox Structure"}),"\n",(0,t.jsxs)(s.p,{children:["The structure for a SmartVanBox is declared into the ",(0,t.jsx)(s.code,{children:"struct.jod"})," file, located\nin the ",(0,t.jsx)(s.code,{children:"$JOD_SV_DIST/configs"})," folder. This file contains an hierarchical\nstructure of ",(0,t.jsx)(s.a,{href:"https://docs.johnosproject.org/references/josp/jod/specs/pillars/",children:"Pillars"}),"\n(from the JOSP EcoSystem). Each pillar represents a state or an action that the\nSmartVanBox can perform. The pillars are grouped into groups, that allows the\nMobile App to navigate through the SmartVanBox structure."]}),"\n",(0,t.jsx)(s.p,{children:"The SmartVan Specs are published on the SmartVanBox's WebSite, here a\nsummary of the SmartVan Specs:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(o.hB,{}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/docs/category/position",children:"Position"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/position/gnss",children:"GNSS"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/position/inertial",children:"Inertial"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/docs/category/sensors",children:"Sensors"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/sensors/living",children:"Living"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/sensors/engine",children:"Engine"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/docs/category/services",children:"Services"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/services/controllers",children:"Controllers"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/services/actuators",children:"Actuators"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/docs/category/energy",children:"Energy"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/energy/storage",children:"Storage"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/energy/generation",children:"Generation"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/energy/consumption",children:"Consumption"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/docs/category/iot",children:"IoT Box"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/iot/battery",children:"Battery"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/iot/internet",children:"Internet"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/iot/accesspoint",children:"Access Point"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/iot/media",children:"Media"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"/docs/specs/iot/monitor",children:"Monitor"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Here an example of the SmartVanBox structure:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "model": "JOD Smart Van",\n  "brand": "John OS",\n  "descr": "IoT agent for the Smart Van Box that provides the Smart Van Specifications.",\n  "descr_long": "This object\'s structure actually contains the \'Position\', \'Sensors\', \'Services\', \'Energy\' and the \'IoT Box > Energy + Internet\' specifications groups",\n  "contains": {\n\n    "Position": {\n      "type": "JODContainer",\n      "contains": {\n        "GNSS": {\n          "type": "JODContainer",\n          "contains": {\n            "Latitude": { ... },\n            "Latitude Degrees": { ... },\n            "Longitude": { ... },\n            "Longitude Degrees": { ... },\n            ...\n          },\n        },\n        "Inertial": {\n          "type": "JODContainer",\n          "contains": {\n            "Roll": { ... },\n            "Pitch": { ... },\n            "Yaw": { ... },\n            ...\n          },\n        },\n      },\n    },\n    "Sensors": { ... },\n    "Services": { ... },\n    "Energy": { ... },\n    "IoT Box": { ... }\n  },\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:"Using this structure, you can easily customize the SmartVanBox structure by\nadding or removing pillars from the structure. But, remember to keep the\nstructure compliant with the SmartVan Specs."}),"\n",(0,t.jsx)(s.h3,{id:"smartvanbox-capabilities",children:"SmartVanBox Capabilities"}),"\n",(0,t.jsxs)(s.p,{children:['So, thanks to the "object\'s structure", each SmartVanBox capability, that is\nexposed to the Mobile App, is defined by a pillar.',(0,t.jsx)("br",{}),"\nEach pillar is defined using different properties depending on the pillar type.\nActually, the SmartVanBox structure is based on the following pillar types:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"Boolean State"}),": provide a 0/1, true/false... state"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"Boolean Action"}),": like the Boolean State, but it can be set remotely"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"Range State"}),": provide a value in a defined range"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"Range Action"}),": like the Range State, but it can be set remotely"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Most of the firmwares from the SmartVan project are using the DBus protocol to\ncomunicate with the JOD daemon. So, the following examples are based on the DBus\nprotocol. Other protocols can be used to communicate with the JOD daemon, like\nHTTP, Shell, File, etc. Checkout the ",(0,t.jsx)(s.a,{href:"https://docs.johnosproject.org/references/josp/jod/specs/workers/",children:"JOSP documentation :: JOD :: workers"})]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Boolean State"})}),"\n",(0,t.jsxs)(s.p,{children:['The "Position > GNSS > Latitude" pillar is a ',(0,t.jsx)(s.code,{children:"Boolean State"})," pillar that provides\nthe latitude's sign (true is North, false is South). And it is defined as follows:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'"Latitude": {\n  "type": "BooleanState",\n  "desc": "GPS latitude (true is North, false is South)",\n  "listener": "dbus://dbus_name=com.simcom;dbus_obj_path=/sim7600;dbus_iface=com.simcom.sim7600;dbus_prop=pos_gps_lat;"\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Range State"})}),"\n",(0,t.jsxs)(s.p,{children:['The "Position > GNSS > Latitude Degrees" pillar is a ',(0,t.jsx)(s.code,{children:"Range State"})," pillar that\nprovides the GPS latitude degrees (from -90 to 90). And it is defined as follows:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'"Latitude Degrees": {\n  "type": "RangeState",\n  "desc": "GPS latitude degrees",\n  "listener": "dbus://dbus_name=com.simcom;dbus_obj_path=/sim7600;dbus_iface=com.simcom.sim7600;dbus_prop=pos_gps_lat_degrees;",\n  "min": "-90",\n  "max": "90",\n  "step": "1"\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Boolean Action"})}),"\n",(0,t.jsxs)(s.p,{children:['The "Position > GNSS > Power Module" pillar is a ',(0,t.jsx)(s.code,{children:"Boolean Action"})," pillar that\nallows to enable/disable the GNSS module. And it is defined as follows:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'"Power Module": {\n  "type": "BooleanAction",\n  "desc": "Power on/off the SIM module (true is on, false if off)",\n  "listener": "dbus://dbus_name=com.simcom;dbus_obj_path=/sim7600;dbus_iface=com.simcom.sim7600;dbus_prop=power_module_state;",\n  "executor": "dbus://dbus_name=com.simcom;dbus_obj_path=/sim7600;dbus_iface=com.simcom.sim7600;dbus_method=power_module;dbus_method_params=%A_VAL%:Boolean;"\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Range Action"})}),"\n",(0,t.jsxs)(s.p,{children:['The "Services > Actuators > DimmerLow > DimmerLow 1" pillar is a ',(0,t.jsx)(s.code,{children:"Range Action"}),"\npillar that allows to set the dimmer's percentage (from 0 to 100). And it is\ndefined as follows:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'"DimmerLow 1": {\n  "type": "RangeAction",\n  "desc": "Percentage actuator for low consumption services like dimmers (0 is off, 100 is completely on).",\n  "listener": "dbus://dbus_name=com.ioexp;dbus_obj_path=/io_expansion_board;dbus_iface=com.ioexp;dbus_prop=NONE;",\n  "executor": "dbus://dbus_name=com.ioexp;dbus_obj_path=/io_expansion_board;dbus_iface=com.ioexp;dbus_method=NONE;dbus_method_params=%VAL%:Boolean;"\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["More info on ",(0,t.jsx)(s.code,{children:"listeners"})," and ",(0,t.jsx)(s.code,{children:"executors"})," can be found on the ",(0,t.jsx)(s.a,{href:"https://docs.johnosproject.org/references/josp/jod/specs/workers/",children:"JOSP documentation :: JOD :: workers"}),"\nand ",(0,t.jsx)(s.a,{href:"https://docs.johnosproject.org/references/josp/jod/specs/pillars/",children:"JOSP documentation :: JOD :: pillars"}),"\npages. Otherwise, you can check directly the specific ",(0,t.jsx)(s.a,{href:"/docs/software#other-sources-and-repositories",children:"firmwares documentation"}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"alternative-jod-structures",children:"Alternative JOD structures"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsxs)(s.strong,{children:["In the JOD Smart Van distribution, edit the ",(0,t.jsx)(s.code,{children:"jod.structure.path"})," from the\n",(0,t.jsx)(s.code,{children:"configs/jod.yml"})]})," file with desired JOD structure file path. The default value\nis ",(0,t.jsx)(s.code,{children:"configs/struct.jod"}),", but you can use one of the following alternative\nstructures or customize your own:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"struct_fw_XY.jod"}),": JOD SV structure but only FW XY's related pillars"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"struct_fw_XY_all.jod"}),": a JOD structure containing all FW XY's provided properties as pillars"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"struct_specs_NAME.jod"}),": a JOD structure containing only pillars for the specifications with NAME sub-group"]}),"\n"]})]})}function g(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(f,{...e})}):f(e)}},9683:(e,s,n)=>{n.d(s,{A:()=>i});n(6540);const t={img_container:"img_container_ABGT",img_link:"img_link_Hl3U",img_tag:"img_tag_oucX"};var r=n(4848);function i(e){return(0,r.jsx)("div",{className:t.img_container,children:(0,r.jsx)("a",{href:e.link?e.link:e.src,className:t.img_link,children:(0,r.jsx)("img",{src:e.src,alt:e.alt,width:e.width?e.width:"100%",className:t.img_tag})})})}},7109:(e,s,n)=>{n.d(s,{A:()=>i});n(6540);const t={container:"container_mzDT",h1:"h1_n6cG"};var r=n(4848);function i(e){return(0,r.jsx)("div",{className:t.container,children:(0,r.jsxs)("h1",{className:t.h1,children:[e.section," - ",e.subsection]})})}},3161:(e,s,n)=>{n.d(s,{r0:()=>h,Wx:()=>i,A:()=>o,PD:()=>c,OM:()=>l,hB:()=>a,Ay:()=>u});n(6540);const t={web_site_map:"web_site_map_qmuZ"};var r=n(4848);function i(){return(0,r.jsx)("a",{href:"/docs",children:"DOCS"})}function o(){return(0,r.jsx)("a",{href:"/docs/features",children:"FEATURES"})}function a(){return(0,r.jsx)("a",{href:"/docs/specs",children:"SPECIFICATIONS"})}function c(){return(0,r.jsx)("a",{href:"/docs/hardware",children:"HARDWARE"})}function l(){return(0,r.jsx)("a",{href:"/docs/software",children:"SOFTWARE"})}function d(){return(0,r.jsx)("a",{href:"/about",children:"ABOUT"})}function h(){return(0,r.jsx)("a",{href:"/collaborate",children:"COLLABORATE"})}function u(){return(0,r.jsxs)("div",{className:t.web_site_map,children:[(0,r.jsx)(o,{}),"|",(0,r.jsx)(c,{}),"|",(0,r.jsx)(l,{}),"|",(0,r.jsx)(a,{}),"|",(0,r.jsx)(d,{}),"|",(0,r.jsx)(h,{})]})}},2349:(e,s,n)=>{n.d(s,{VG:()=>l,N8:()=>h,e0:()=>d,Uo:()=>c});n(6540);const t={tmpl_container:"tmpl_container_A9hk",specs_table:"specs_table_BWcA",head_container:"head_container_KR7S",descr:"descr_CuXp",lists_container:"lists_container_Qejd",logo:"logo_Y7bK",list:"list_tLdV",list_item:"list_item_WUvh"};var r=n(9683),i=n(7109),o=n(3161),a=n(4848);function c(e){return(0,a.jsx)(i.A,{section:"Software",subsection:e.name})}function l(e){return(0,a.jsxs)("div",{className:t.head_container,children:[(0,a.jsxs)("div",{className:t.lists_container,children:[e.url_logo?(0,a.jsxs)("div",{children:[(0,a.jsx)(r.A,{src:e.url_logo,width:"200px"}),(0,a.jsx)("hr",{})]}):null,(0,a.jsx)("h3",{children:"Status"}),(0,a.jsxs)("ul",{className:t.list,children:[(0,a.jsxs)("li",{className:t.list_item,children:[(0,a.jsx)("b",{children:"Status:"})," ",e.current_status]}),(0,a.jsxs)("li",{className:t.list_item,children:[(0,a.jsx)("b",{children:"Version:"})," ",e.current_version]}),(0,a.jsxs)("li",{className:t.list_item,children:[(0,a.jsx)("b",{children:"Category:"})," ",e.category]}),(0,a.jsxs)("li",{className:t.list_item,children:[(0,a.jsx)("b",{children:"Language:"})," ",e.language]}),(0,a.jsxs)("li",{className:t.list_item,children:[(0,a.jsx)("b",{children:"Code:"})," ",e.code]})]}),(0,a.jsx)("hr",{}),(0,a.jsx)("h3",{children:"Links"}),(0,a.jsxs)("ul",{className:t.list,children:[e.url_repo?(0,a.jsx)("li",{className:t.list_item,children:(0,a.jsx)("a",{href:e.url_repo+"",children:"Git Repo"})}):"",e.url_docs?(0,a.jsx)("li",{className:t.list_item,children:(0,a.jsx)("a",{href:e.url_docs+"",children:"Docs"})}):"",e.url_downloads?(0,a.jsx)("li",{className:t.list_item,children:(0,a.jsx)("a",{href:e.url_downloads+"",children:"Downloads"})}):"",e.url_support?(0,a.jsx)("li",{className:t.list_item,children:(0,a.jsx)("a",{href:e.url_support+"",children:"Support"})}):""]})]}),(0,a.jsx)("div",{className:t.descr,children:e.children})]})}function d(){return(0,a.jsxs)("p",{children:["The following table lists all Smart Van ",(0,a.jsx)(o.hB,{})," that can be provided by this firmware. Then, you can use this info to customize the `struct.jod` file of the ",(0,a.jsx)("a",{href:"/docs/software/jod_smart_van/jod_smart_van",children:"JOD Smart Van"})," distribution."]})}function h(e){return(0,a.jsxs)("table",{className:t.specs_table,children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Property Name"}),(0,a.jsx)("th",{children:"Specification"})]}),Object.keys(e.specs_provided).map(((s,n)=>{const t=e.specs_provided[s].fw_value,r=e.specs_provided[s].group,i=e.specs_provided[s].sub_group,o=e.specs_provided[s].spec;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("code",{children:t})}),(0,a.jsx)("td",{children:(0,a.jsxs)("a",{href:"/docs/specs/"+r+"/"+i+"#"+o,children:[r," > ",i," > ",o]})})]},n)}))]})}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>a});var t=n(6540);const r={},i=t.createContext(r);function o(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);