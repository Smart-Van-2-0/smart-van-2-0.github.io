"use strict";(self.webpackChunksmart_van_2_0_github_io=self.webpackChunksmart_van_2_0_github_io||[]).push([[9977],{7141:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>j,frontMatter:()=>a,metadata:()=>c,software_category:()=>p,software_code:()=>m,software_language:()=>v,software_name:()=>d,software_status:()=>h,software_version:()=>u,toc:()=>x});var t=s(4848),i=s(8453),r=s(2349);const a={title:"Simulate a SmartVanBox on Development Machine",hide_title:!0,sidebar_position:41},o=void 0,c={id:"software/sv_mobile_app/android/guides/simulate_svbox_on_dev_machine",title:"Simulate a SmartVanBox on Development Machine",description:"\x3c!--",source:"@site/docs/software/sv_mobile_app/android/guides/simulate_svbox_on_dev_machine.mdx",sourceDirName:"software/sv_mobile_app/android/guides",slug:"/software/sv_mobile_app/android/guides/simulate_svbox_on_dev_machine",permalink:"/docs/software/sv_mobile_app/android/guides/simulate_svbox_on_dev_machine",draft:!1,unlisted:!1,editUrl:"https://github.com/smart-van-2-0/smart-van-2-0.github.io/edit/main/docs/software/sv_mobile_app/android/guides/simulate_svbox_on_dev_machine.mdx",tags:[],version:"current",sidebarPosition:41,frontMatter:{title:"Simulate a SmartVanBox on Development Machine",hide_title:!0,sidebar_position:41},sidebar:"docsSidebar",previous:{title:"Develop the SmartVan Mobile App",permalink:"/docs/software/sv_mobile_app/android/guides/develop_smartvan_mobile_app"},next:{title:"Smart Van - iOS",permalink:"/docs/software/sv_mobile_app/ios/"}},l={},d="Smart Van for Android",h="Development",m="sv_mobile_app_android",u="0.1.0",p="Mobile App",v="Java",x=[{value:"Simulate a SmartVanBox on Development Machine",id:"simulate-a-smartvanbox-on-development-machine",level:2},{value:"Start Docker Container",id:"start-docker-container",level:3},{value:"Install Software Requirements",id:"install-software-requirements",level:3},{value:"Download and Configure JOD SmartVan Distribution",id:"download-and-configure-jod-smartvan-distribution",level:3},{value:"Start JOD SmartVan Distribution",id:"start-jod-smartvan-distribution",level:3}];function _(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Uo,{name:d,status:h}),"\n",(0,t.jsx)(n.h2,{id:"simulate-a-smartvanbox-on-development-machine",children:"Simulate a SmartVanBox on Development Machine"}),"\n",(0,t.jsx)(n.p,{children:"During the development and testing of the SmartVan Mobile App, a SmartVanBox\ndevice is often required. To simulate a SmartVanBox on any PC, you can create a\nDocker container that clones the source code of the JOD SmartVan Distribution\nand generates the distribution itself."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Short Steps"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Start Docker Container"}),"\n",(0,t.jsx)(n.li,{children:"Install Software Requirements"}),"\n",(0,t.jsx)(n.li,{children:"Download and Configure JOD SmartVan Distribution"}),"\n",(0,t.jsx)(n.li,{children:"Start JOD SmartVan Distribution"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"start-docker-container",children:"Start Docker Container"}),"\n",(0,t.jsxs)(n.p,{children:["After installing Docker, you can clone the ",(0,t.jsx)(n.a,{href:"https://github.com/Smart-Van-2-0/com.robypomper.smartvan.app.android",children:"SmartVan Mobile App repo"}),"\nand start a container based on \u2018Ubuntu\u2019. This container will share the\n",(0,t.jsx)(n.code,{children:"jod_svbox.sh"})," file (from the root directory of the mobile app project) and the\nhost system's DBus socket."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"$ git clone https://github.com/Smart-Van-2-0/com.robypomper.smartvan.app.android.git\n$ sudo docker run --privileged --network host \\\n   -v .:/home/ubuntu \\\n   -v /run/dbus/system_bus_socket:/run/dbus/system_bus_socket \\\n   -it ubuntu /bin/bash\n[sudo] password for user: xxxxxx\nroot@05c16c828bd6:/#\n"})}),"\n",(0,t.jsx)(n.p,{children:"Now you are inside the container, which also includes the source code of the\nmobile app and the jod_svbox.sh file."}),"\n",(0,t.jsx)(n.h3,{id:"install-software-requirements",children:"Install Software Requirements"}),"\n",(0,t.jsx)(n.p,{children:"The JOD daemon, as well as the various firmware, requires libraries and tools to\nfunction properly. In this step, all necessary dependencies are installed:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["for Scripts: ",(0,t.jsx)(n.code,{children:"git curl wget nano"})]}),"\n",(0,t.jsxs)(n.li,{children:["for JOD: ",(0,t.jsx)(n.code,{children:"openjdk-11-jdk avahi-utils"})]}),"\n",(0,t.jsxs)(n.li,{children:["for Firmware: ",(0,t.jsx)(n.code,{children:"python3 python3-pip python3-venv libcairo2-dev libgirepository1.0-dev dbus-x11"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Additionally, since the Docker container does not have an associated init system,\nyou need to manually start a DBus session."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# apt-get update && apt-get install -y \\\n   git curl wget nano \\\n   openjdk-11-jdk avahi-utils \\\n   python3 python3-pip python3-venv \\\n   libcairo2-dev libgirepository1.0-dev dbus-x11\n# exec dbus-run-session -- bash\n"})}),"\n",(0,t.jsx)(n.h3,{id:"download-and-configure-jod-smartvan-distribution",children:"Download and Configure JOD SmartVan Distribution"}),"\n",(0,t.jsxs)(n.p,{children:["Navigate to the SmartVan Mobile App directory and obtain the JOD SmartVan project\nusing the ",(0,t.jsx)(n.code,{children:"jod_svbox.sh"})," script. The ",(0,t.jsx)(n.code,{children:"init"})," sub-command will clone the main\nproject, while the start sub-command will attempt to ",(0,t.jsx)(n.code,{children:"start"})," the distribution but\nwill fail initially. This is expected!"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"start"})," sub-command will download the dependencies of the JOD SmartVan\nDistribution, i.e., its firmware."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# cd /home/ubuntu/com.robypomper.smartvan.app.android/\n# bash jod_svbox.sh init\n# bash jod_svbox.sh start\n"})}),"\n",(0,t.jsx)(n.p,{children:"The JOD SmartVan Distribution does not start because its scripts require an\nInit System, which the Docker container cannot provide. To bypass this, remove\nthe line of code that performs this check."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# sed -i '95d' ../com.robypomper.smartvan.jod_smart_van/build/JOD_Smart_Van/1.0.0/scripts/jod/jod-script-configs.sh\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Now we are ready to configure the distribution and set the simulation mode, as\nwell as the use of Python 'venv' by the firmware. In the ",(0,t.jsx)(n.code,{children:"configs.sh"})," file,\nuncomment the ",(0,t.jsx)(n.code,{children:"SIMULATE"})," and ",(0,t.jsx)(n.code,{children:"VENV"})," variables, both should be ",(0,t.jsx)(n.code,{children:"true"}),". More info\non ",(0,t.jsx)(n.a,{href:"/docs/software/jod_smart_van/jod_smart_van/guides/configure_jod_sv_dist",children:"JOD SmartVan Distitribution configs"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Next, initialize the Python 'venv' for each firmware:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# cd ../com.robypomper.smartvan.jod_smart_van/build/JOD_Smart_Van/1.0.0/deps/com.robypomper.smartvan.fw.victron/\n# python3 -m venv venv; source venv/bin/activate; pip install -r requirements.txt; deactivate; cd -\n# cd ../com.robypomper.smartvan.jod_smart_van/build/JOD_Smart_Van/1.0.0/deps/com.robypomper.smartvan.fw.sim7600/\n# python3 -m venv venv; source venv/bin/activate; pip install -r requirements.txt; deactivate; cd -\n# cd ../com.robypomper.smartvan.jod_smart_van/build/JOD_Smart_Van/1.0.0/deps/com.robypomper.smartvan.fw.upspack_v3/\n# python3 -m venv venv; source venv/bin/activate; pip install -r requirements.txt; deactivate; cd -\n# cd ../com.robypomper.smartvan.jod_smart_van/build/JOD_Smart_Van/1.0.0/deps/com.robypomper.smartvan.fw.sensehat/\n# python3 -m venv venv; source venv/bin/activate; pip install -r requirements.txt; deactivate; cd -\n# cd ../com.robypomper.smartvan.jod_smart_van/build/JOD_Smart_Van/1.0.0/deps/com.robypomper.smartvan.fw.ioexp/\n# python3 -m venv venv; source venv/bin/activate; pip install -r requirements.txt; deactivate; cd -\n"})}),"\n",(0,t.jsx)(n.p,{children:"For each firmware, the following sequence of commands is executed:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Create ",(0,t.jsx)(n.code,{children:"venv"})]}),"\n",(0,t.jsxs)(n.li,{children:["Activate ",(0,t.jsx)(n.code,{children:"venv"})]}),"\n",(0,t.jsx)(n.li,{children:"Install requirements"}),"\n",(0,t.jsxs)(n.li,{children:["Deactivate ",(0,t.jsx)(n.code,{children:"venv"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"start-jod-smartvan-distribution",children:"Start JOD SmartVan Distribution"}),"\n",(0,t.jsxs)(n.p,{children:["Now we are ready to start our JOD SmartVan Distribution. From the SmartVan Mobile\nApp directory, execute again the ",(0,t.jsx)(n.code,{children:"start"})," sub-command of the ",(0,t.jsx)(n.code,{children:"jod_svbox.sh"}),"\nscript. If everything is configured correctly, this command will start the JOD\ndaemon and various firmware for the JOD SmartVan distribution."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"bash jod_svbox.sh start\nbash jod_svbox.sh logs\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note:"})," The logs sub-command may not work correctly, so you can use an\nalternative command:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# tail -f /home/ubuntu/com.robypomper.smartvan.jod_smart_van/build/JOD_Smart_Van/1.0.0/logs/jospJSL.log\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To verify that the distribution is running, you can use the ",(0,t.jsx)(n.code,{children:"state"})," sub-command.\nIf running, you can stop it with the ",(0,t.jsx)(n.code,{children:"stop"})," sub-command."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"bash jod_svbox.sh state\nbash jod_svbox.sh stop\n"})})]})}function j(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(_,{...e})}):_(e)}},9683:(e,n,s)=>{s.d(n,{A:()=>r});s(6540);const t={img_container:"img_container_ABGT",img_link:"img_link_Hl3U",img_tag:"img_tag_oucX"};var i=s(4848);function r(e){return(0,i.jsx)("div",{className:t.img_container,children:(0,i.jsx)("a",{href:e.link?e.link:e.src,className:t.img_link,children:(0,i.jsx)("img",{src:e.src,alt:e.alt,width:e.width?e.width:"100%",className:t.img_tag})})})}},7109:(e,n,s)=>{s.d(n,{A:()=>r});s(6540);const t={container:"container_mzDT",h1:"h1_n6cG"};var i=s(4848);function r(e){return(0,i.jsx)("div",{className:t.container,children:(0,i.jsxs)("h1",{className:t.h1,children:[e.section," - ",e.subsection]})})}},3161:(e,n,s)=>{s.d(n,{r0:()=>h,Wx:()=>r,A:()=>a,PD:()=>c,OM:()=>l,hB:()=>o,Ay:()=>m});s(6540);const t={web_site_map:"web_site_map_qmuZ"};var i=s(4848);function r(){return(0,i.jsx)("a",{href:"/docs",children:"DOCS"})}function a(){return(0,i.jsx)("a",{href:"/docs/features",children:"FEATURES"})}function o(){return(0,i.jsx)("a",{href:"/docs/specs",children:"SPECIFICATIONS"})}function c(){return(0,i.jsx)("a",{href:"/docs/hardware",children:"HARDWARE"})}function l(){return(0,i.jsx)("a",{href:"/docs/software",children:"SOFTWARE"})}function d(){return(0,i.jsx)("a",{href:"/about",children:"ABOUT"})}function h(){return(0,i.jsx)("a",{href:"/collaborate",children:"COLLABORATE"})}function m(){return(0,i.jsxs)("div",{className:t.web_site_map,children:[(0,i.jsx)(a,{}),"|",(0,i.jsx)(c,{}),"|",(0,i.jsx)(l,{}),"|",(0,i.jsx)(o,{}),"|",(0,i.jsx)(d,{}),"|",(0,i.jsx)(h,{})]})}},2349:(e,n,s)=>{s.d(n,{VG:()=>l,N8:()=>h,e0:()=>d,Uo:()=>c});s(6540);const t={tmpl_container:"tmpl_container_A9hk",specs_table:"specs_table_BWcA",head_container:"head_container_KR7S",descr:"descr_CuXp",lists_container:"lists_container_Qejd",logo:"logo_Y7bK",list:"list_tLdV",list_item:"list_item_WUvh"};var i=s(9683),r=s(7109),a=s(3161),o=s(4848);function c(e){return(0,o.jsx)(r.A,{section:"Software",subsection:e.name})}function l(e){return(0,o.jsxs)("div",{className:t.head_container,children:[(0,o.jsxs)("div",{className:t.lists_container,children:[e.url_logo?(0,o.jsxs)("div",{children:[(0,o.jsx)(i.A,{src:e.url_logo,width:"200px"}),(0,o.jsx)("hr",{})]}):null,(0,o.jsx)("h3",{children:"Status"}),(0,o.jsxs)("ul",{className:t.list,children:[(0,o.jsxs)("li",{className:t.list_item,children:[(0,o.jsx)("b",{children:"Status:"})," ",e.current_status]}),(0,o.jsxs)("li",{className:t.list_item,children:[(0,o.jsx)("b",{children:"Version:"})," ",e.current_version]}),(0,o.jsxs)("li",{className:t.list_item,children:[(0,o.jsx)("b",{children:"Category:"})," ",e.category]}),(0,o.jsxs)("li",{className:t.list_item,children:[(0,o.jsx)("b",{children:"Language:"})," ",e.language]}),(0,o.jsxs)("li",{className:t.list_item,children:[(0,o.jsx)("b",{children:"Code:"})," ",e.code]})]}),(0,o.jsx)("hr",{}),(0,o.jsx)("h3",{children:"Links"}),(0,o.jsxs)("ul",{className:t.list,children:[e.url_repo?(0,o.jsx)("li",{className:t.list_item,children:(0,o.jsx)("a",{href:e.url_repo+"",children:"Git Repo"})}):"",e.url_docs?(0,o.jsx)("li",{className:t.list_item,children:(0,o.jsx)("a",{href:e.url_docs+"",children:"Docs"})}):"",e.url_downloads?(0,o.jsx)("li",{className:t.list_item,children:(0,o.jsx)("a",{href:e.url_downloads+"",children:"Downloads"})}):"",e.url_support?(0,o.jsx)("li",{className:t.list_item,children:(0,o.jsx)("a",{href:e.url_support+"",children:"Support"})}):""]})]}),(0,o.jsx)("div",{className:t.descr,children:e.children})]})}function d(){return(0,o.jsxs)("p",{children:["The following table lists all Smart Van ",(0,o.jsx)(a.hB,{})," that can be provided by this firmware. Then, you can use this info to customize the `struct.jod` file of the ",(0,o.jsx)("a",{href:"/docs/software/jod_smart_van/jod_smart_van",children:"JOD Smart Van"})," distribution."]})}function h(e){return(0,o.jsxs)("table",{className:t.specs_table,children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Property Name"}),(0,o.jsx)("th",{children:"Specification"})]}),Object.keys(e.specs_provided).map(((n,s)=>{const t=e.specs_provided[n].fw_value,i=e.specs_provided[n].group,r=e.specs_provided[n].sub_group,a=e.specs_provided[n].spec;return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)("code",{children:t})}),(0,o.jsx)("td",{children:(0,o.jsxs)("a",{href:"/docs/specs/"+i+"/"+r+"#"+a,children:[i," > ",r," > ",a]})})]},s)}))]})}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);